"use strict";(self.webpackChunknullaha_github_io=self.webpackChunknullaha_github_io||[]).push([[1858],{985:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>t,default:()=>p,frontMatter:()=>i,metadata:()=>d,toc:()=>o});var l=n(4848),s=n(8453);const i={sidebar_position:2,title:"\u5c06mxd\u4e2d\u7684\u56fe\u5c42\u6837\u5f0f\u8f6c\u4e3asld\u6587\u4ef6",description:"\u5c06mxd\u4e2d\u7684\u56fe\u5c42\u6837\u5f0f\u8f6c\u4e3asld\u6587\u4ef6",date:"2024-6-11",tags:["mxd","sld","gis","qgis","esri","python"]},t=void 0,d={id:"gis/\u6837\u5f0f/mxd2sld",title:"\u5c06mxd\u4e2d\u7684\u56fe\u5c42\u6837\u5f0f\u8f6c\u4e3asld\u6587\u4ef6",description:"\u5c06mxd\u4e2d\u7684\u56fe\u5c42\u6837\u5f0f\u8f6c\u4e3asld\u6587\u4ef6",source:"@site/docs/gis/\u6837\u5f0f/mxd2sld.mdx",sourceDirName:"gis/\u6837\u5f0f",slug:"/gis/\u6837\u5f0f/mxd2sld",permalink:"/docs/gis/\u6837\u5f0f/mxd2sld",draft:!1,unlisted:!1,tags:[{label:"mxd",permalink:"/docs/tags/mxd"},{label:"sld",permalink:"/docs/tags/sld"},{label:"gis",permalink:"/docs/tags/gis"},{label:"qgis",permalink:"/docs/tags/qgis"},{label:"esri",permalink:"/docs/tags/esri"},{label:"python",permalink:"/docs/tags/python"}],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"\u5c06mxd\u4e2d\u7684\u56fe\u5c42\u6837\u5f0f\u8f6c\u4e3asld\u6587\u4ef6",description:"\u5c06mxd\u4e2d\u7684\u56fe\u5c42\u6837\u5f0f\u8f6c\u4e3asld\u6587\u4ef6",date:"2024-6-11",tags:["mxd","sld","gis","qgis","esri","python"]},sidebar:"gisSidebar",previous:{title:"\u6837\u5f0f",permalink:"/docs/category/\u6837\u5f0f"},next:{title:"sld",permalink:"/docs/gis/\u6837\u5f0f/sld"}},a={},o=[{value:"\u9700\u6c42",id:"\u9700\u6c42",level:2},{value:"\u601d\u8def",id:"\u601d\u8def",level:2},{value:"\u601d\u8def0\uff1a",id:"\u601d\u8def0",level:3},{value:"\u601d\u8def1\uff1a.mxd -&gt; esri .style  -&gt; qgis slyr2.0 -&gt; .xml -&gt; .sld",id:"\u601d\u8def1mxd---esri-style----qgis-slyr20---xml---sld",level:3},{value:"\u601d\u8def2\uff1a.mxd  -&gt;  .lyr -&gt; qgis slyr(community) -&gt; .qlr -&gt; export .sld",id:"\u601d\u8def2mxd-----lyr---qgis-slyrcommunity---qlr---export-sld",level:3},{value:"\u624b\u52a8\u64cd\u4f5c .mxd  -&gt;  .lyr",id:"\u624b\u52a8\u64cd\u4f5c-mxd-----lyr",level:2},{value:"\u6279\u91cf\u64cd\u4f5c .mxd  -&gt;  .lyr",id:"\u6279\u91cf\u64cd\u4f5c-mxd-----lyr",level:2},{value:"\u601d\u8def",id:"\u601d\u8def-1",level:3},{value:"\u5b9e\u73b0",id:"\u5b9e\u73b0",level:3},{value:"\u4ee3\u7801",id:"\u4ee3\u7801",level:3},{value:"\u51fa\u73b0\u7684\u95ee\u9898",id:"\u51fa\u73b0\u7684\u95ee\u9898",level:3},{value:"1 \u4f7f\u7528vscode\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u4f1a\u4e71\u7801 ?",id:"1-\u4f7f\u7528vscode\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u4f1a\u4e71\u7801-",level:4},{value:"2 \u4f7f\u7528arcmap\u81ea\u5e26\u7684idle\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u7684\u5904\u7406 ?",id:"2-\u4f7f\u7528arcmap\u81ea\u5e26\u7684idle\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u7684\u5904\u7406-",level:4},{value:"3 mxd\u4e2d\u7684\u56fe\u5c42\u6ca1\u6709data source\u65e0\u6cd5\u4f7f\u7528arccpy.saveToLayerFile_management Failed to execute (SaveToLayerFile) ?",id:"3-mxd\u4e2d\u7684\u56fe\u5c42\u6ca1\u6709data-source\u65e0\u6cd5\u4f7f\u7528arccpysavetolayerfile_management-failed-to-execute-savetolayerfile-",level:4},{value:"qgis\u4e2d\u5c55\u793a .lyr",id:"qgis\u4e2d\u5c55\u793a-lyr",level:2},{value:"\u601d\u8def",id:"\u601d\u8def-2",level:3},{value:"1 \u5b89\u88c5slyr\u63d2\u4ef6",id:"1-\u5b89\u88c5slyr\u63d2\u4ef6",level:3},{value:"\u51fa\u73b0\u7684\u95ee\u9898",id:"\u51fa\u73b0\u7684\u95ee\u9898-1",level:3},{value:"1 <code>SLYR (Community Edition)</code>\u5b89\u88c5\u540e\u5de5\u5177\u7bb1\u5904\u4e0d\u663e\u793a ?",id:"1-slyr-community-edition\u5b89\u88c5\u540e\u5de5\u5177\u7bb1\u5904\u4e0d\u663e\u793a-",level:4},{value:"\u624b\u52a8\u64cd\u4f5c .lyr -&gt; .sld",id:"\u624b\u52a8\u64cd\u4f5c-lyr---sld",level:2},{value:"\u6279\u91cf\u64cd\u4f5c .lyr -&gt; .qlr -&gt; .sld",id:"\u6279\u91cf\u64cd\u4f5c-lyr---qlr---sld",level:2},{value:"\u5728\u54ea\u5199\u4ee3\u7801?",id:"\u5728\u54ea\u5199\u4ee3\u7801",level:3},{value:"<del>\u5c06lyr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6</del>",id:"\u5c06lyr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6",level:3},{value:"\u5c06lyr\u6587\u4ef6\u8f6c\u4e3aqlr\u6587\u4ef6",id:"\u5c06lyr\u6587\u4ef6\u8f6c\u4e3aqlr\u6587\u4ef6",level:3},{value:"\u5c06qlr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6",id:"\u5c06qlr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6",level:3},{value:"\u51fa\u73b0\u7684\u95ee\u9898",id:"\u51fa\u73b0\u7684\u95ee\u9898-2",level:3},{value:"1 SyntaxError: (unicode error) &#39;unicodeescape&#39; codec ?",id:"1-syntaxerror-unicode-error-unicodeescape-codec-",level:4},{value:"2 processing script editor  Seems there is no valid script in the file ?",id:"2-processing-script-editor--seems-there-is-no-valid-script-in-the-file-",level:4},{value:"3 qlr\u592a\u591a\uff0c\u8fd0\u884c\u4ee3\u7801\u540e\uff0cqgis\u53ef\u80fd\u4f1a\u5361\u4f4f ?",id:"3-qlr\u592a\u591a\u8fd0\u884c\u4ee3\u7801\u540eqgis\u53ef\u80fd\u4f1a\u5361\u4f4f-",level:4},{value:"\u53c2\u8003\uff1a",id:"\u53c2\u8003",level:2},{value:"\u6700\u7ec8\u4ee3\u7801",id:"\u6700\u7ec8\u4ee3\u7801",level:2}];function c(e){const r={a:"a",admonition:"admonition",br:"br",code:"code",del:"del",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.h2,{id:"\u9700\u6c42",children:"\u9700\u6c42"}),"\n",(0,l.jsx)(r.p,{children:"\u7ed9\u4e86\u4e00\u5806\u6ca1\u6709\u6570\u636e\u6e90\u7684mxd\u6587\u4ef6\uff0c\u60f3\u8981\u5b83\u7684sld\u6837\u5f0f\u6587\u4ef6\u3002"}),"\n",(0,l.jsx)(r.h2,{id:"\u601d\u8def",children:"\u601d\u8def"}),"\n",(0,l.jsx)(r.h3,{id:"\u601d\u8def0",children:"\u601d\u8def0\uff1a"}),"\n",(0,l.jsx)(r.p,{children:".lyr -> qgis slyr(community) export .sld\u7684\u95ee\u9898\uff1a  \u80fd\u7528python\u6279\u91cf\u64cd\u4f5c\u5417\uff1f"}),"\n",(0,l.jsx)(r.p,{children:"\u5728python\u4e2d\u4f7f\u7528qgis api\uff1f"}),"\n",(0,l.jsx)(r.p,{children:"\u65e0\u6cd5\u89e3\u6790\u5bfc\u5165\u201cqgis.core\u201d\uff0c\u5728VSCode\u4e2d\u914d\u7f6eQGIS Python\u89e3\u91ca\u5668\uff1f"}),"\n",(0,l.jsx)(r.h3,{id:"\u601d\u8def1mxd---esri-style----qgis-slyr20---xml---sld",children:"\u601d\u8def1\uff1a.mxd -> esri .style  -> qgis slyr2.0 -> .xml -> .sld"}),"\n",(0,l.jsx)(r.p,{children:"\u672c\u6765\u7684\u601d\u8def\u662f\u8fd9\u6837\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u4f46\u662f\u751f\u6210\u7684xml\u8fd8\u9700\u8981\u6211\u5199\u4ee3\u7801\u8f6c\u4e3asld\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u540e\u6765\u5076\u7136\u53d1\u73b0qgis\u91cc\u53ef\u4ee5\u76f4\u63a5\u4fdd\u5b58\u6837\u5f0f\u4e3asld\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u601d\u8def2mxd-----lyr---qgis-slyrcommunity---qlr---export-sld",children:"\u601d\u8def2\uff1a.mxd  ->  .lyr -> qgis slyr(community) -> .qlr -> export .sld"}),"\n",(0,l.jsxs)(r.ol,{children:["\n",(0,l.jsx)(r.li,{children:"mxd\u8f6c\u4e3a.lyr"}),"\n",(0,l.jsx)(r.li,{children:"\u5728qgis\u4e2d\u5c55\u793a.lyr\u6587\u4ef6 (qgis\u4e0d\u652f\u6301\u9700\u8981\u5b89\u88c5slyr\u540e\u81ea\u52a8\u652f\u6301\u4e86)"}),"\n",(0,l.jsx)(r.li,{children:(0,l.jsx)(r.del,{children:"pyqgis \u5c06 lyr \u5bfc\u51fa\u4e3a sld"})}),"\n",(0,l.jsx)(r.li,{children:"pyqgis \u5c06lyr \u8f6c\u4e3a qlr (slyr\u652f\u6301)"}),"\n",(0,l.jsx)(r.li,{children:"pyqgis \u5c06qlr \u8f6c\u4e3a sld"}),"\n"]}),"\n",(0,l.jsx)(r.p,{children:"\u8bef\u6253\u8bef\u649e"}),"\n",(0,l.jsx)(r.h2,{id:"\u624b\u52a8\u64cd\u4f5c-mxd-----lyr",children:"\u624b\u52a8\u64cd\u4f5c .mxd  ->  .lyr"}),"\n",(0,l.jsx)(r.p,{children:"\u624b\u52a8\u64cd\u4f5c\u5f88\u7b80\u5355..."}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{alt:"\u4fdd\u5b58\u4e3alyr",src:n(5727).A+"",width:"668",height:"891"})}),"\n",(0,l.jsx)(r.h2,{id:"\u6279\u91cf\u64cd\u4f5c-mxd-----lyr",children:"\u6279\u91cf\u64cd\u4f5c .mxd  ->  .lyr"}),"\n",(0,l.jsx)(r.p,{children:"\u56e0\u4e3a\u6211\u6709\u5f88\u591amxd\u6587\u4ef6\uff0c\u6240\u4ee5\u9700\u8981\u6279\u91cf\u64cd\u4f5c\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u601d\u8def-1",children:"\u601d\u8def"}),"\n",(0,l.jsx)(r.p,{children:"\u7528arcpy."}),"\n",(0,l.jsx)(r.p,{children:"\u6253\u5f00mxd\u6587\u4ef6\uff0c\u904d\u5386\u91cc\u9762\u7684\u56fe\u5c42\uff0c\u4fdd\u5b58\u56fe\u5c42\u4e3alyr\u6587\u4ef6\uff0c\u5173\u95edmxd\u6587\u4ef6\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u5b9e\u73b0",children:"\u5b9e\u73b0"}),"\n",(0,l.jsxs)(r.ol,{children:["\n",(0,l.jsx)(r.li,{children:"\u904d\u5386\u6587\u4ef6\u5939\u4e2d\u7684mxd\u6587\u4ef6"}),"\n",(0,l.jsx)(r.li,{children:"\u6253\u5f00mxd\u6587\u4ef6\uff0c\u904d\u5386\u91cc\u9762\u7684\u56fe\u5c42\uff0c\u4fdd\u5b58\u56fe\u5c42\u4e3alyr\u6587\u4ef6\uff08\u5982\u679c\u5e02\u56fe\u5c42\u7ec4\u5219\u7ee7\u7eed\u904d\u5386\u56fe\u5c42\u7ec4\uff09\u3002"}),"\n",(0,l.jsx)(r.li,{children:"\u5728mxd\u6587\u4ef6\u76ee\u5f55\u4e0b\u521b\u5efa\u540c\u540d\u6587\u4ef6\u5939\uff0c\u751f\u6210\u7684lyr\u6587\u4ef6\u5c31\u5b58\u5230\u8fd9\u91cc\uff08\u5982\u679cmxd\u91cc\u7684\u56fe\u5c42\u662f\u4e2a\u7ec4\uff0c\u6211\u4f1a\u7ee7\u7eed\u521b\u5efa\u6587\u4ef6\u5939\u6765\u4fdd\u5b58\u7ec4\uff09\u3002"}),"\n"]}),"\n",(0,l.jsx)(r.h3,{id:"\u4ee3\u7801",children:"\u4ee3\u7801"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-py",children:"# -*- coding: cp936 -*-\n\nimport arcpy\nimport os\n\ntop_directory = r\"C:\\\u6d4b\u8bd5mxd2lyr\"\n\ndef save_layers_from_mxd(mxd_name,mxd_path, output_dir):\n\n    # \u521b\u5efamxd\u540c\u540d\u7684\u6587\u4ef6\u5939\n    new_output_dir = os.path.join(output_dir, mxd_name)\n    if not os.path.exists(new_output_dir):\n        os.makedirs(new_output_dir)\n\n    try:\n        mxd = arcpy.mapping.MapDocument(mxd_path)\n        layers = arcpy.mapping.ListLayers(mxd)\n\n        for layer in layers:\n            aa = isinstance(layer, arcpy.mapping.Layer)\n            print(aa)\n            bb= layer.supports(\"DATASOURCE\") #\u56fe\u5c42\u662f\u5426\u6709\u6570\u636e\u6e90\n            print(bb)\n            # layer.save()\n            \n            if layer.isGroupLayer:\n                print('isGroupLayer--------------')\n              \n                sublayers = layer\n\n                # \u521b\u5efa\u5f53\u524d\u56fe\u5c42\u540c\u540d\u7684\u6587\u4ef6\u5939\n                new_output_dir2 = os.path.join(new_output_dir, layer.name)\n                if not os.path.exists(new_output_dir2):\n                    os.makedirs(new_output_dir2)\n\n                for sublayer in sublayers:\n                    name = sublayer.name\n                    new_output_layer2 = os.path.join(new_output_dir2, name + \".lyr\")\n                    sublayer.saveACopy(new_output_layer2)\n            else:\n                name = layer.name\n                print('layer---------------')\n                new_output_layer = os.path.join(new_output_dir, name + \".lyr\")\n\n                #arcpy.SaveToLayerFile_management(layer, output_layer)\n                layer.saveACopy(new_output_layer)\n        del mxd\n    except Exception as e:\n        print(\"Error processing\")\n        print(e)\ndef traverse_and_process(directory):\n    print(directory)\n    for root, dirs, files in os.walk(directory):\n        for file in files:\n            if file.endswith(\".mxd\"):\n                \n                print('-----------\u6211\u8fdb\u6765\u4e86---------')\n                mxd_path = os.path.join(root, file)\n                output_dir = root\n                mxd_path = unicode(mxd_path,'cp936')\n                mxd_name, _ = os.path.splitext(file)\n                mxd_name = unicode(mxd_name,'cp936')\n                output_dir = unicode(output_dir,'cp936')\n                \n                save_layers_from_mxd(mxd_name,mxd_path, output_dir)\n\nprint('---------traverse_and_process-------------')\ntraverse_and_process(top_directory)\n\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u51fa\u73b0\u7684\u95ee\u9898",children:"\u51fa\u73b0\u7684\u95ee\u9898"}),"\n",(0,l.jsxs)(r.admonition,{type:"danger",children:[(0,l.jsx)(r.h4,{id:"1-\u4f7f\u7528vscode\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u4f1a\u4e71\u7801-",children:"1 \u4f7f\u7528vscode\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u4f1a\u4e71\u7801 ?"}),(0,l.jsx)(r.p,{children:"\u6211\u4e00\u5f00\u59cb\u5728vscode\u4e2d\u5199\u4ee3\u7801\uff0c\u7528\u7684python\u73af\u5883\u662farcmap\u5e26\u7684python2.x\u3002\u4f46\u662f\u8fd0\u884c\u540e\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u4e2d\u6587\u8def\u5f84\u4f1a\u4e71\u7801\u3002"}),(0,l.jsxs)(r.p,{children:["\u89e3\u51b3\uff1a",(0,l.jsx)(r.br,{}),"\n",(0,l.jsx)(r.img,{alt:"\u89e3\u51b3vscode\u4fdd\u5b58py\u7f16\u7801\u9009\u62e9",src:n(197).A+"",width:"1150",height:"589"})]}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://www.cnblogs.com/liweis/p/13069311.html",children:"\u53c2\u8003\uff1a\u4f7f\u7528vs code\u7b49\u7f16\u8f91\u5668\u4fdd\u5b58py\u6587\u4ef6\u65f6\uff0c\u6ce8\u610f\u7f16\u7801\u7684\u9009\u62e9"})}),(0,l.jsx)(r.p,{children:"\u53ef\u4ee5\u8fd0\u884c\uff0c\u4f46\u662f\u4fdd\u5b58\u540e\u7684\u6587\u4ef6\u5728vscode\u91cc\u6253\u5f00\u4e2d\u6587\u5168\u663e\u793a\u4e71\u7801\uff0c\u6240\u4ee5\u6211\u653e\u5f03\u4e86\u3002"}),(0,l.jsx)(r.p,{children:"\u6211\u76f4\u63a5\u5728arcmap\u5e26\u7684 **IDLE(Python GUI)**\u4e2d\u5199\u4ee3\u7801\u54af\u3002"}),(0,l.jsx)(r.h4,{id:"2-\u4f7f\u7528arcmap\u81ea\u5e26\u7684idle\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u7684\u5904\u7406-",children:"2 \u4f7f\u7528arcmap\u81ea\u5e26\u7684idle\u5199\u4ee3\u7801\u9047\u5230\u4e2d\u6587\u7684\u5904\u7406 ?"}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://nullaha.github.io/docs/gis/arcpy%E4%B8%ADpython2.x%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98",children:"\u53c2\u8003\uff1aarcpy\u4e2dpython2.x\u7f16\u7801\u95ee\u9898"})}),(0,l.jsx)(r.h4,{id:"3-mxd\u4e2d\u7684\u56fe\u5c42\u6ca1\u6709data-source\u65e0\u6cd5\u4f7f\u7528arccpysavetolayerfile_management-failed-to-execute-savetolayerfile-",children:"3 mxd\u4e2d\u7684\u56fe\u5c42\u6ca1\u6709data source\u65e0\u6cd5\u4f7f\u7528arccpy.saveToLayerFile_management Failed to execute (SaveToLayerFile) ?"}),(0,l.jsx)(r.p,{children:"mxd\u4e2d\u7684\u56fe\u5c42\u6ca1\u6709data source,\u4f1a\u62a5Failed to execute. Parameters are not valid.ERROR 000840: The value is not a Layer.Failed to execute (SaveToLayerFile).\u9519\u8bef\u3002"}),(0,l.jsx)(r.p,{children:"\u6211\u4e3a\u4ec0\u4e48\u8001\u6293\u8fd9saveToLayerFile_management\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u653e\u5462\uff0c\u6211\u770b\u4e86arcpy\u7684layer\u7c7b\u6587\u6863\u540e\uff0c\u53d1\u73b0\u53ef\u4ee5\u76f4\u63a5\u7528layer.save()\u6765\u4fdd\u5b58lyr\u5440\u3002"}),(0,l.jsx)(r.p,{children:"\u5224\u65ad\u56fe\u5c42\u662f\u5426\u6709\u6570\u636e\u6e90\uff1a"}),(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-py",children:'layer.supports("DATASOURCE")\nlayer.dataSource\n'})}),(0,l.jsx)(r.p,{children:"\u53c2\u8003\uff1a"}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://support.esri.com/zh-cn/knowledge-base/use-python-to-list-the-data-sources-of-all-layers-in-th-000011530",children:"\u5224\u65ad\u56fe\u5c42\u662f\u5426\u6709\u6570\u636e\u6e90"})}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://desktop.arcgis.com/zh-cn/arcmap/latest/analyze/arcpy-mapping/layer-class.html",children:"arcpy\u7684layer\u7c7b"})}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://community.esri.com/t5/python-questions/save-layer-file-with-python/td-p/298685",children:"Save Layer File with Python"})}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://gis.stackexchange.com/questions/78082/how-to-save-all-layers-in-a-mxd-with-arcpy",children:"How to save all layers in a MXD with arcpy"})})]}),"\n",(0,l.jsx)(r.h2,{id:"qgis\u4e2d\u5c55\u793a-lyr",children:"qgis\u4e2d\u5c55\u793a .lyr"}),"\n",(0,l.jsx)(r.h3,{id:"\u601d\u8def-2",children:"\u601d\u8def"}),"\n",(0,l.jsx)(r.p,{children:"qgis\u4e0d\u652f\u6301/\u4e0d\u8bc6\u522besri\u7684lyr\u6587\u4ef6"}),"\n",(0,l.jsx)(r.p,{children:"\u5b89\u88c5slyr\u63d2\u4ef6"}),"\n",(0,l.jsx)(r.p,{children:"\u4f7f\u7528slyr\u63d2\u4ef6\u5728qgis\u4e2d\u6253\u5f00lyr\u6587\u4ef6"}),"\n",(0,l.jsx)(r.h3,{id:"1-\u5b89\u88c5slyr\u63d2\u4ef6",children:"1 \u5b89\u88c5slyr\u63d2\u4ef6"}),"\n",(0,l.jsxs)(r.p,{children:["\u76f4\u63a5qgis\u63d2\u4ef6\u4e2d\u641c\u7d22 ",(0,l.jsx)(r.code,{children:"SLYR (Community Edition)"})," \u5b89\u88c5\u5c31\u884c\u3002"]}),"\n",(0,l.jsxs)(r.p,{children:["\u5b89\u88c5\u540e\u9700\u8981\u5728 Processing Toolbox -> options -> SLYR  \u4e2d\u5904\u7406mdbtools \u548cinkscape\u3002\n",(0,l.jsx)(r.a,{href:"https://nullaha.github.io/docs/gis/%E4%BD%BF%E7%94%A8qgis%E5%B0%86esri%20style%E8%BD%AC%E4%B8%BAxml",children:"\u53c2\u8003\uff1aSLYR  \u4e2d\u5904\u7406mdbtools \u548cinkscape"})]}),"\n",(0,l.jsx)(r.h3,{id:"\u51fa\u73b0\u7684\u95ee\u9898-1",children:"\u51fa\u73b0\u7684\u95ee\u9898"}),"\n",(0,l.jsxs)(r.admonition,{type:"danger",children:[(0,l.jsxs)(r.h4,{id:"1-slyr-community-edition\u5b89\u88c5\u540e\u5de5\u5177\u7bb1\u5904\u4e0d\u663e\u793a-",children:["1 ",(0,l.jsx)(r.code,{children:"SLYR (Community Edition)"}),"\u5b89\u88c5\u540e\u5de5\u5177\u7bb1\u5904\u4e0d\u663e\u793a ?"]}),(0,l.jsx)(r.p,{children:"\u91cd\u65b0\u542f\u52a8qgis"})]}),"\n",(0,l.jsx)(r.h2,{id:"\u624b\u52a8\u64cd\u4f5c-lyr---sld",children:"\u624b\u52a8\u64cd\u4f5c .lyr -> .sld"}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{alt:"\u5c06lyr\u5bfc\u51fa\u4e3asld",src:n(8572).A+"",width:"765",height:"633"})}),"\n",(0,l.jsx)(r.h2,{id:"\u6279\u91cf\u64cd\u4f5c-lyr---qlr---sld",children:"\u6279\u91cf\u64cd\u4f5c .lyr -> .qlr -> .sld"}),"\n",(0,l.jsx)(r.h3,{id:"\u5728\u54ea\u5199\u4ee3\u7801",children:"\u5728\u54ea\u5199\u4ee3\u7801?"}),"\n",(0,l.jsx)(r.p,{children:"\u672c\u6765\u6253\u7b97\u7528vscode\u5199\uff0c\u5728\u7f51\u4e0a\u641c\u4e86\u597d\u51e0\u5708\u600e\u4e48\u914d\u73af\u5883\u90fd\u4e0d\u884c\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u518d\u52a0\u4e0a\u6d89\u53ca\u5230\u8981\u914d\u73af\u5883\u53d8\u91cf\uff0c\u6211\u7535\u8111\u91cc\u672c\u6765\u5c31\u6709\u4e00\u4e2a\u7248\u672c\u7684python\u4e86\uff0c\u518d\u914d\u4e00\u4e2a\u7248\u672c\u7684py\u53d8\u91cf\u4f1a\u6709\u95ee\u9898\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u6240\u4ee5\u6211\u653e\u5f03\u4e86\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u76f4\u63a5\u5728gqis\u91cc\u5199\u3002"}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.img,{alt:"qgis\u4e2dpython\u7f16\u8f91\u5668",src:n(3990).A+"",width:"395",height:"188"}),"\n",(0,l.jsx)(r.img,{alt:"qgis\u4e2d\u6253\u5f00python console",src:n(2003).A+"",width:"444",height:"110"})]}),"\n",(0,l.jsx)(r.p,{children:"\u8fd9\u6837\u5c31\u53ef\u4ee5\u5199\u4ee3\u7801\uff0c\u7136\u540e\u5728python console\u4e2d\u770b\u8fd0\u884c\u540e\u7684\u6253\u5370\u3001\u62a5\u9519\u4fe1\u606f\u4e86\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u5c06lyr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6",children:(0,l.jsx)(r.del,{children:"\u5c06lyr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6"})}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u8bd5\u4e86\uff0c\u53cd\u6b63\u6211\u4e0d\u884c\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u8ba4\u4e3a\u672c\u8d28\u4e0a\u8fd8\u662fqgis\u4e0d\u652f\u6301lyr\u3002"}),"\n",(0,l.jsx)(r.p,{children:"\u9700\u8981\u501f\u52a9slyr\u63d2\u4ef6\u624d\u884c\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u5c06lyr\u6587\u4ef6\u8f6c\u4e3aqlr\u6587\u4ef6",children:"\u5c06lyr\u6587\u4ef6\u8f6c\u4e3aqlr\u6587\u4ef6"}),"\n",(0,l.jsx)(r.p,{children:"\u90a3\u5c31\u591a\u505a\u4e00\u6b65\uff0c\u501f\u52a9slyr\u5c06\u6240\u6709\u7684lyr\u8f6c\u4e3aqlr\u3002"}),"\n",(0,l.jsxs)(r.p,{children:["\u5728python scrpit\u4e2d\u600e\u4e48\u4f7f\u7528\u8fd9\u4e2a\u63d2\u4ef6\u5462?",(0,l.jsx)(r.br,{}),"\n",(0,l.jsx)(r.img,{alt:"convert_lyr_to_qlr",src:n(8391).A+"",width:"429",height:"245"})]}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{alt:"copy_as_py_command",src:n(1764).A+"",width:"981",height:"775"})}),"\n",(0,l.jsx)(r.p,{children:"\u7c98\u8d34\u677f\u4e0a\u4f1a\u5b58\u8fd9\u4e2a\u547d\u4ee4\u7684py\u4ee3\u7801\uff0c\u7167\u846b\u82a6\u753b\u74e2\u5199\u5c31\u884c\u3002"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-py",children:"# \u8fd9\u662fcopy as py command \u7ed9\u6211\u7684\uff1a\n# processing.run(\"slyr:lyrtoqlr\", {'INPUT':'C:\\\\Users\\\\Aha\\\\Downloads\\\\\u6751\u7ea7\u754c\u7ebf.lyr','USE_RELATIVE_PATHS':False,'OUTPUT':'TEMPORARY_OUTPUT'})\n\n# \u5c06lyr\u8f6c\u4e3aqlr\ndef convert_lyr_to_qlr(lyr_path):\n    qlr_path = os.path.splitext(lyr_path)[0] + \".qlr\"\n    processing.run(\"slyr:lyrtoqlr\", {'INPUT': lyr_path, 'USE_RELATIVE_PATHS': False, 'OUTPUT': qlr_path})\n    print(f\"Converted {lyr_path} to {qlr_path}\")\n\n# \u6279\u91cf\u5904\u7406\ndef run_lyr_to_qlr(lyr_dir):\n    for root, dirs, files in os.walk(lyr_dir):\n        for file_name in files:\n            if file_name.endswith(\".lyr\"):\n                lyr_path = os.path.join(root, file_name)\n                convert_lyr_to_qlr(lyr_path)\n"})}),"\n",(0,l.jsx)(r.h3,{id:"\u5c06qlr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6",children:"\u5c06qlr\u6587\u4ef6\u8f6c\u4e3asld\u6587\u4ef6"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-py",children:'def convert_qlr_to_sld(qlr_path):\n    project = QgsProject.instance()\n    QgsLayerDefinition.loadLayerDefinition(qlr_path, project, project.layerTreeRoot())\n    layers = project.mapLayers().values()\n    layer = list(layers)[-1]  # \u62ff\u56fe\u5c42\u9762\u677f\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u56fe\u5c42\u54af\n\n    #if not layer.isValid(): # \u5982\u679c\u6ca1\u6709\u6570\u636e\u6e90\u8fd9\u91cc\u4f1a\u8fd4\u56detrue\uff0c\u6240\u4ee5\u6211\u6ce8\u91ca\u6389\u4e86\u3002\n        #print(f"Failed to load {qlr_path}")\n        #return\n\n    # \u751f\u6210\u8f93\u51fa\u6587\u4ef6\u8def\u5f84\uff08\u548cqlr\u540c\u540d\u540c\u76ee\u5f55\u54af\uff09\n    sld_path = os.path.splitext(qlr_path)[0] + ".sld"\n    \n    # \u4fdd\u5b58\u4e3a SLD \u6587\u4ef6\n    success = layer.saveSldStyle(sld_path)\n    if success:\n        print(f"Successfully converted {qlr_path} to {sld_path}")\n    else:\n        print(f"Failed to save {sld_path}")\n\n    # \u4eceQGIS\u9879\u76ee\u4e2d\u79fb\u9664\u56fe\u5c42\n    project.removeMapLayer(layer.id())\n'})}),"\n",(0,l.jsx)(r.h3,{id:"\u51fa\u73b0\u7684\u95ee\u9898-2",children:"\u51fa\u73b0\u7684\u95ee\u9898"}),"\n",(0,l.jsxs)(r.admonition,{type:"danger",children:[(0,l.jsx)(r.h4,{id:"1-syntaxerror-unicode-error-unicodeescape-codec-",children:"1 SyntaxError: (unicode error) 'unicodeescape' codec ?"}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.img,{alt:"111",src:n(5934).A+"",width:"625",height:"313"})}),(0,l.jsxs)(r.p,{children:["\u4f7f\u7528\u539f\u59cb\u5b57\u7b26\u4e32\uff08\u5728\u5b57\u7b26\u4e32\u524d\u52a0 r\uff09\u6216\u8005\u5c06\u53cd\u659c\u6760\u66ff\u6362\u4e3a\u53cc\u53cd\u659c\u6760\u3002",(0,l.jsx)(r.br,{}),"\n","aa = r''"]}),(0,l.jsx)(r.h4,{id:"2-processing-script-editor--seems-there-is-no-valid-script-in-the-file-",children:"2 processing script editor  Seems there is no valid script in the file ?"}),(0,l.jsx)(r.p,{children:"\u70b9\u8fd0\u884c\u4ee3\u7801\u540e\uff0c\u4ee3\u7801\u6267\u884c\u4e86\uff0c\u4f46\u662f\u4f1a\u5f39\u7a97\u63d0\u793a\u3002"}),(0,l.jsx)(r.p,{children:"\u6ca1\u5173\u7cfb\uff0c\u53ea\u8981\u4e0d\u662fconsole\u91cc\u6709\u62a5\u9519\u4fe1\u606f\u90fd\u4e0d\u5f71\u54cd\u4ee3\u7801\u7684\u8fd0\u884c\u7684\u3002"}),(0,l.jsx)(r.p,{children:"\uff08\u5b83\u53ea\u662f\u63d0\u9192\u4f60\u8fd0\u884c\u7684\u8fd9\u6bb5\u4ee3\u7801\u4e0d\u662f\u4e00\u4e2a\u6709\u6548\u7684processing script\u800c\u5df2\uff09"}),(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://gis.stackexchange.com/questions/467817/simple-script-is-working-in-python-console-but-gets-error-in-script-editor-pyqg"})}),(0,l.jsx)(r.h4,{id:"3-qlr\u592a\u591a\u8fd0\u884c\u4ee3\u7801\u540eqgis\u53ef\u80fd\u4f1a\u5361\u4f4f-",children:"3 qlr\u592a\u591a\uff0c\u8fd0\u884c\u4ee3\u7801\u540e\uff0cqgis\u53ef\u80fd\u4f1a\u5361\u4f4f ?"}),(0,l.jsx)(r.p,{children:"\u4e0d\u8981\u52a8\uff0c\u4ee3\u7801\u5728\u6267\u884c\u5462\u3002\u4e00\u4f1a\u5c31\u597d\u4e86\u3002"})]}),"\n",(0,l.jsx)(r.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003\uff1a"}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.a,{href:"https://www.burdgis.com/blog/view/convert-arcgis-layer-files-lyr-to-qgis-styles-qml/",children:"Convert ArcGIS layer files (.lyr) to QGIS styles (.qml)"}),(0,l.jsx)(r.br,{}),"\n",(0,l.jsx)(r.a,{href:"https://north-road.com/slyr/",children:"slyr\u6587\u6863"}),(0,l.jsx)(r.br,{}),"\n",(0,l.jsx)(r.a,{href:"https://blog.csdn.net/bamboo_2001/article/details/129544529",children:"qgis\u811a\u672c--\u6279\u91cf\u5bfc\u51fasld"})]}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://gis.stackexchange.com/questions/432664/loading-qlr-file-in-qgis-using-pyqgis",children:"Loading QLR file in QGIS using PyQGIS"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://blog.csdn.net/dragonzoebai/article/details/127065748",children:"arcgis\u7684lyr\u6837\u5f0f\u8f6cqgis\u7684sld\u6837\u5f0f"})}),"\n",(0,l.jsx)(r.p,{children:(0,l.jsx)(r.a,{href:"https://medium.com/@gianfrancodipietro/convertire-gli-stili-da-arcgis-lyr-9cc8cd32a89b",children:"Convertire gli stili da ArcGis (.lyr) a Qgis, pubblicare sul web con OpenLayers"})}),"\n",(0,l.jsx)(r.h2,{id:"\u6700\u7ec8\u4ee3\u7801",children:"\u6700\u7ec8\u4ee3\u7801"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-py",children:'import os\nfrom qgis.core import QgsProject,QgsVectorLayer,QgsLayerTreeLayer,QgsApplication,QgsLayerDefinition,QgsRuleBasedRenderer\nfrom qgis.gui import QgsLayerTreeView\nfrom qgis.analysis import QgsNativeAlgorithms\nimport processing\nprint(1)\n\n#\u8bbe\u7f6e.lyr folder\nlyr_dir = r\'C:\\Users\\Downloads\\\u6d4b\u8bd5lyr\'\n\n# \u6ce8\u518c\u5904\u7406\u63d2\u4ef6\nQgsApplication.processingRegistry().addProvider(QgsNativeAlgorithms())\n\n\ndef convert_lyr_to_qlr(lyr_path):\n    qlr_path = os.path.splitext(lyr_path)[0] + ".qlr"\n    processing.run("slyr:lyrtoqlr", {\'INPUT\': lyr_path, \'USE_RELATIVE_PATHS\': False, \'OUTPUT\': qlr_path})\n    print(f"Converted {lyr_path} to {qlr_path}")\n\ndef convert_qlr_to_sld(qlr_path):\n    project = QgsProject.instance()\n    QgsLayerDefinition.loadLayerDefinition(qlr_path, project, project.layerTreeRoot())\n    layers = QgsProject.instance().mapLayers().values()\n    layer = list(layers)[-1]\n    print(\'aaaabb\')\n\n    #if not layer.isValid():\n        #print(f"Failed to load {qlr_path}")\n        #return\n    #for renderer in layer.renderer().symbol().symbolLayers():\n\n    # todo:\u4fee\u6539\u6e32\u67d3\u5668\u89c4\u5219\u7684\u540d\u79f0\n\n    # \u751f\u6210\u8f93\u51fa\u6587\u4ef6\u8def\u5f84\n    sld_path = os.path.splitext(qlr_path)[0] + ".sld"\n    \n    # \u4fdd\u5b58\u4e3a SLD \u6587\u4ef6\n    success = layer.saveSldStyle(sld_path)\n    if success:\n        print(f"Successfully converted {qlr_path} to {sld_path}")\n    else:\n        print(f"Failed to save {sld_path}")\n\n    # \u4eceQGIS\u9879\u76ee\u4e2d\u79fb\u9664\u56fe\u5c42\n    QgsProject.instance().removeMapLayer(layer.id())\n\n                \n\n# \u7b2c\u4e00\u6b65\uff1a\u5c06\u6240\u6709 .lyr \u6587\u4ef6\u8f6c\u6362\u4e3a .qlr \u6587\u4ef6\ndef run_lyr_to_qlr(lyr_dir):\n    for root, dirs, files in os.walk(lyr_dir):\n        for file_name in files:\n            if file_name.endswith(".lyr"):\n                lyr_path = os.path.join(root, file_name)\n                convert_lyr_to_qlr(lyr_path)\n\n\n\n# \u7b2c\u4e8c\u6b65\uff1a\u5c06\u6240\u6709 .qlr \u6587\u4ef6\u8f6c\u6362\u4e3a .sld \u6587\u4ef6\ndef run_batch_qlr(lyr_dir):\n    for root, dirs, files in os.walk(lyr_dir):\n        for file_name in files:\n            if file_name.endswith(".qlr"):\n                qlr_path = os.path.join(root, file_name)\n                convert_qlr_to_sld(qlr_path)\n       \n\n# \u6267\u884c       \n#run_lyr_to_qlr(lyr_dir)\nrun_batch_qlr(lyr_dir)\n\n\n'})}),"\n",(0,l.jsx)(r.hr,{})]})}function p(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8391:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/convert_lyr_to_qlr-df48313d976ad61c1d7fd34fe21a5b1d.png"},1764:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/copy_as_py_command-e14a5765e68ba9f483d5b17c1f81b13d.png"},3990:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/qgis\u4e2dpython\u7f16\u8f91\u5668-28a57a8806a566707e79a285d44dfc84.png"},2003:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/qgis\u4e2d\u6253\u5f00py_console-35fd3ecd394d91cf9ae00d4e5bec4240.png"},5727:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/save_as_layer_file-02dba1aa39ee47157135ec95891b81df.png"},8572:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/save_as_qgis_style_file-edbe99b046d3f6563f14b886d441a3f6.png"},5934:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/unicode_error-f591b3277ce7b3ddb4c8e2604d6d477c.png"},197:(e,r,n)=>{n.d(r,{A:()=>l});const l=n.p+"assets/images/\u89e3\u51b3vscode\u4fdd\u5b58py\u7f16\u7801\u9009\u62e9-394ca04afbb85d77467b88cfefddb75c.png"},8453:(e,r,n)=>{n.d(r,{R:()=>t,x:()=>d});var l=n(6540);const s={},i=l.createContext(s);function t(e){const r=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),l.createElement(i.Provider,{value:r},e.children)}}}]);